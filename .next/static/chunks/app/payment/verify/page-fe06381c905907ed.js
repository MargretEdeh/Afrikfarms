(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[57],{12862:(e,a,t)=>{"use strict";t.d(a,{A:()=>l});let r=t(95125).A.create({baseURL:"https://backend-api.afrikfarm.com/api/v1",headers:{"Content-Type":"application/json"}});r.interceptors.request.use(e=>{let a=localStorage.getItem("token");return a&&(e.headers.Authorization="Bearer ".concat(a)),e});let l=r},20063:(e,a,t)=>{"use strict";var r=t(47260);t.o(r,"usePathname")&&t.d(a,{usePathname:function(){return r.usePathname}}),t.o(r,"useRouter")&&t.d(a,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(a,{useSearchParams:function(){return r.useSearchParams}})},22393:(e,a,t)=>{Promise.resolve().then(t.bind(t,25829))},25016:(e,a,t)=>{"use strict";t.d(a,{cn:()=>n});var r=t(2821),l=t(75889);function n(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return(0,l.QP)((0,r.$)(a))}},25829:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>m});var r=t(95155),l=t(12115),n=t(92850),s=t(20063),i=t(35299),o=t(61362),c=t(78874),d=t(97003);function u(){var e,a;let{verifyPayment:t}=(0,n.e)(),u=(0,s.useRouter)(),m=(0,s.useSearchParams)(),[f,y]=(0,l.useState)("verifying"),[g,p]=(0,l.useState)(null),[v,h]=(0,l.useState)(""),[b,w]=(0,l.useState)(null);(0,l.useEffect)(()=>{let e=m.get("reference"),a=m.get("trxref");if(e||(e=localStorage.getItem("paystack_ref")),h(localStorage.getItem("payment_amount")||"0"),localStorage.removeItem("paystack_ref"),localStorage.removeItem("payment_amount"),!e){y("failed"),p("Missing payment reference in URL or storage.");return}(async()=>{var r,l,n,s,i,o,c;try{let o=await t(a||e,e);if((null==o||null==(r=o.payment)?void 0:r.status)==="Paid"||(null==o||null==(l=o.payment)?void 0:l.has_paid)===!0||(null==o||null==(n=o.message)?void 0:n.toLowerCase().includes("successful"))){y("success"),w(o);let e=null==o||null==(s=o.payment)?void 0:s.amount;e&&e>0&&h(e.toString())}else y("failed"),p((null==o?void 0:o.message)||(null==o||null==(i=o.data)?void 0:i.gateway_response)||"Payment verification failed. Please contact support.")}catch(e){y("failed"),p((null==(c=e.response)||null==(o=c.data)?void 0:o.message)||e.message||"An unexpected error occurred during verification.")}})()},[m,t]);let x=(null==b||null==(e=b.payment)?void 0:e.amount)?Number.parseFloat(b.payment.amount).toLocaleString():Number.parseFloat(v).toLocaleString();return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen p-4 text-center",children:["verifying"===f&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.A,{className:"mb-4 h-16 w-16 text-primary animate-spin"}),(0,r.jsx)("h1",{className:"text-2xl font-semibold",children:"Verifying Payment..."}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Please wait, do not close this page."})]}),"success"===f&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.A,{className:"mb-4 h-16 w-16 text-green-500"}),(0,r.jsx)("h1",{className:"text-2xl font-semibold",children:"Payment Successful!"}),(0,r.jsxs)("p",{className:"text-muted-foreground mt-2",children:["Payment of ",(0,r.jsxs)("span",{className:"font-bold text-green-600",children:["â‚¦",x]})," has been confirmed."]}),(null==b||null==(a=b.data)?void 0:a.fullname)&&(0,r.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:["For farmer: ",(0,r.jsx)("span",{className:"font-medium",children:b.data.fullname})]}),(0,r.jsx)(d.$,{onClick:()=>u.push("/dashboard"),className:"mt-6",children:"Go to Dashboard"})]}),"failed"===f&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.A,{className:"mb-4 h-16 w-16 text-red-500"}),(0,r.jsx)("h1",{className:"text-2xl font-semibold",children:"Payment Failed"}),(0,r.jsx)("p",{className:"text-red-600 font-medium",children:g}),(0,r.jsx)("p",{className:"text-muted-foreground mt-2",children:"Please check your bank statement or try again."}),(0,r.jsx)(d.$,{onClick:()=>u.push("/farmers"),className:"mt-6",children:"Return to Farmers"})]})]})}function m(){return(0,r.jsx)(l.Suspense,{fallback:(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:"Loading..."}),children:(0,r.jsx)(u,{})})}},32467:(e,a,t)=>{"use strict";t.d(a,{DX:()=>i,TL:()=>s});var r=t(12115),l=t(94446),n=t(95155);function s(e){let a=function(e){let a=r.forwardRef((e,a)=>{let{children:t,...n}=e;if(r.isValidElement(t)){var s;let e,i,o=(s=t,(i=(e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?s.ref:(i=(e=Object.getOwnPropertyDescriptor(s,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?s.props.ref:s.props.ref||s.ref),c=function(e,a){let t={...a};for(let r in a){let l=e[r],n=a[r];/^on[A-Z]/.test(r)?l&&n?t[r]=(...e)=>{let a=n(...e);return l(...e),a}:l&&(t[r]=l):"style"===r?t[r]={...l,...n}:"className"===r&&(t[r]=[l,n].filter(Boolean).join(" "))}return{...e,...t}}(n,t.props);return t.type!==r.Fragment&&(c.ref=a?(0,l.t)(a,o):o),r.cloneElement(t,c)}return r.Children.count(t)>1?r.Children.only(null):null});return a.displayName=`${e}.SlotClone`,a}(e),t=r.forwardRef((e,t)=>{let{children:l,...s}=e,i=r.Children.toArray(l),o=i.find(c);if(o){let e=o.props.children,l=i.map(a=>a!==o?a:r.Children.count(e)>1?r.Children.only(null):r.isValidElement(e)?e.props.children:null);return(0,n.jsx)(a,{...s,ref:t,children:r.isValidElement(e)?r.cloneElement(e,void 0,l):null})}return(0,n.jsx)(a,{...s,ref:t,children:l})});return t.displayName=`${e}.Slot`,t}var i=s("Slot"),o=Symbol("radix.slottable");function c(e){return r.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===o}},35299:(e,a,t)=>{"use strict";t.d(a,{A:()=>r});let r=(0,t(71847).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},48465:(e,a,t)=>{"use strict";t.d(a,{_:()=>l});var r=t(12862);let l={getDashboard:async()=>(await r.A.get("/lga/dashboard")).data,createFarmer:async e=>(await r.A.post("/lga/create-farmer",e)).data,getFarmers:async()=>(await r.A.get("/lga/farmers")).data,getFarmerById:async e=>(await r.A.get("/lga/farmers/".concat(e))).data,sendCode:async e=>(await r.A.post("/lga/send-code",e)).data,verifyCode:async e=>(await r.A.post("/lga/verify-code",e)).data,verifyNin:async e=>(await r.A.post("/lga/verify-nin",e)).data,uploadProfileImage:async(e,a)=>(await r.A.post("/lga/upload-profile-image",e,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:a})).data,UploadProofOfAddress:async(e,a)=>(await r.A.post("/lga/upload-proof-of-address",e,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:a})).data,getBanks:async()=>(await r.A.get("/banks")).data,getAccountName:async e=>(await r.A.get("/get-account-name",{params:{bank_code:e.bankCode,account_number:e.accountNumber}})).data,updateFarmer:async(e,a)=>(await r.A.put("/lga/farmers/".concat(e),a)).data,deleteFarmer:async e=>(await r.A.delete("/lga/farmers/".concat(e))).data,getFarms:async()=>(await r.A.get("/lga/farms")).data,createFarm:async e=>(await r.A.post("/lga/create-farm",e)).data,deleteFarm:async e=>(await r.A.delete("/lga/delete-farm?farm_id=".concat(e))).data,updateFarm:async(e,a)=>(await r.A.put("/lga/update-farm?farm_id=".concat(e),a)).data,getFarmById:async e=>(await r.A.get("/lga/get-farm?farm_id=".concat(e))).data,getFarmersFarms:async e=>(await r.A.get("/lga/farmers-farms?farmer_id=".concat(e))).data,initializePayment:async e=>{console.log("=== PAYMENT INITIALIZATION DEBUG ==="),console.log("1. Data received by service:",e),console.log("2. Data stringified:",JSON.stringify(e));try{let a=await r.A.post("/lga/initialize-payment",e);return console.log("3. Full response received:",a),console.log("4. Response data:",a.data),a.data}catch(e){var a,t;throw console.error("4. Error caught in service:",e),console.error("5. Error response data:",null==(a=e.response)?void 0:a.data),console.error("6. Error request data:",null==(t=e.config)?void 0:t.data),e}},verifyPayment:async(e,a)=>(await r.A.get("/lga/verify-payment?trxref=".concat(e,"&reference=").concat(a))).data}},61362:(e,a,t)=>{"use strict";t.d(a,{A:()=>r});let r=(0,t(71847).A)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},78874:(e,a,t)=>{"use strict";t.d(a,{A:()=>r});let r=(0,t(71847).A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},83101:(e,a,t)=>{"use strict";t.d(a,{F:()=>s});var r=t(2821);let l=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,n=r.$,s=(e,a)=>t=>{var r;if((null==a?void 0:a.variants)==null)return n(e,null==t?void 0:t.class,null==t?void 0:t.className);let{variants:s,defaultVariants:i}=a,o=Object.keys(s).map(e=>{let a=null==t?void 0:t[e],r=null==i?void 0:i[e];if(null===a)return null;let n=l(a)||l(r);return s[e][n]}),c=t&&Object.entries(t).reduce((e,a)=>{let[t,r]=a;return void 0===r||(e[t]=r),e},{});return n(e,o,null==a||null==(r=a.compoundVariants)?void 0:r.reduce((e,a)=>{let{class:t,className:r,...l}=a;return Object.entries(l).every(e=>{let[a,t]=e;return Array.isArray(t)?t.includes({...i,...c}[a]):({...i,...c})[a]===t})?[...e,t,r]:e},[]),null==t?void 0:t.class,null==t?void 0:t.className)}},92850:(e,a,t)=>{"use strict";t.d(a,{LGAProvider:()=>i,e:()=>o});var r=t(95155),l=t(12115),n=t(48465);let s=(0,l.createContext)(void 0),i=e=>{let{children:a}=e,[t,i]=(0,l.useState)([]),[o,c]=(0,l.useState)([]),[d,u]=(0,l.useState)(null),[m,f]=(0,l.useState)(!1),[y,g]=(0,l.useState)(null),p=(0,l.useCallback)(()=>g(null),[]),v=(0,l.useCallback)(async()=>{f(!0),g(null);try{let e=await n._.getDashboard();u(e)}catch(t){var e,a;throw g((null==(a=t.response)||null==(e=a.data)?void 0:e.message)||"Failed to fetch dashboard data"),t}finally{f(!1)}},[]),h=(0,l.useCallback)(async()=>{f(!0),g(null);try{let e=await n._.getFarmers(),a=(null==e?void 0:e.data)||[];i(a)}catch(t){var e,a;throw g((null==(a=t.response)||null==(e=a.data)?void 0:e.message)||"Failed to fetch farmers"),t}finally{f(!1)}},[]),b=(0,l.useCallback)(async e=>{f(!0),g(null);try{let a=await n._.getFarmerById(e);return a.farmer||a}catch(e){var a,t;throw g((null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to fetch farmer"),e}finally{f(!1)}},[]),w=(0,l.useCallback)(async e=>{f(!0),g(null);try{let a=await n._.createFarmer(e);return await h(),a}catch(e){var a,t;throw g((null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to create farmer"),e}finally{f(!1)}},[h]),x=(0,l.useCallback)(async(e,a)=>{f(!0),g(null);try{await n._.updateFarmer(e,a),await h()}catch(e){var t,r;throw g((null==(r=e.response)||null==(t=r.data)?void 0:t.message)||"Failed to update farmer"),e}finally{f(!1)}},[h]),k=(0,l.useCallback)(async e=>{f(!0),g(null);try{await n._.deleteFarmer(e),i(a=>a.filter(a=>a.id!==e))}catch(e){var a,t;throw g((null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to delete farmer"),e}finally{f(!1)}},[]),F=(0,l.useCallback)(async()=>{f(!0),g(null);try{let e=await n._.getFarms(),a=e.data||e.farms||e||[];c(Array.isArray(a)?a:[])}catch(t){var e,a;throw g((null==(a=t.response)||null==(e=a.data)?void 0:e.message)||"Failed to fetch farms"),c([]),t}finally{f(!1)}},[]),A=(0,l.useCallback)(async e=>{f(!0),g(null);try{let a=await n._.getFarmById(e);return a.farm||a}catch(e){var a,t;throw g((null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to fetch farm"),e}finally{f(!1)}},[]),_=(0,l.useCallback)(async e=>{f(!0),g(null);try{let a=await n._.getFarmersFarms(e);return a.farms||a}catch(e){var a,t;throw g((null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to fetch farmer farms"),e}finally{f(!1)}},[]),C=(0,l.useCallback)(async e=>{f(!0),g(null);try{let a=await n._.createFarm(e);return await F(),a}catch(e){var a,t;throw g((null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to create farm"),e}finally{f(!1)}},[F]),N=(0,l.useCallback)(async(e,a)=>{f(!0),g(null);try{await n._.updateFarm(e,a),await F()}catch(e){var t,r;throw g((null==(r=e.response)||null==(t=r.data)?void 0:t.message)||"Failed to update farm"),e}finally{f(!1)}},[F]),j=(0,l.useCallback)(async e=>{f(!0),g(null);try{await n._.deleteFarm(e),c(a=>a.filter(a=>a.id!==e))}catch(e){var a,t;throw g((null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to delete farm"),e}finally{f(!1)}},[]),P=(0,l.useCallback)(async e=>{f(!0),g(null);try{return await n._.sendCode(e)}catch(e){var a,t;throw g((null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to send code"),e}finally{f(!1)}},[]),S=(0,l.useCallback)(async e=>{f(!0),g(null);try{return await n._.verifyCode(e)}catch(e){var a,t;throw g((null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to verify code"),e}finally{f(!1)}},[]),I=(0,l.useCallback)(async e=>{f(!0),g(null);try{return await n._.verifyNin(e)}catch(e){var a,t;throw g((null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to verify NIN"),e}finally{f(!1)}},[]),E=(0,l.useCallback)(async e=>{f(!0),g(null);try{return await n._.initializePayment(e)}catch(e){var a,t;throw g((null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to initialize payment"),e}finally{f(!1)}},[]),z=(0,l.useCallback)(async(e,a)=>{f(!0),g(null);try{return await n._.verifyPayment(e,a)}catch(e){var t,r;throw g((null==(r=e.response)||null==(t=r.data)?void 0:t.message)||"Failed to verify payment"),e}finally{f(!1)}},[]);return(0,r.jsx)(s.Provider,{value:{farmers:t,farms:o,dashboard:d,loading:m,error:y,fetchDashboard:v,fetchFarmers:h,getFarmerById:b,createFarmer:w,updateFarmer:x,deleteFarmer:k,fetchFarms:F,getFarmById:A,getFarmersFarms:_,createFarm:C,updateFarm:N,deleteFarm:j,sendCode:P,verifyCode:S,verifyNin:I,initailizePayment:E,verifyPayment:z,clearError:p},children:a})},o=()=>{let e=(0,l.useContext)(s);if(!e)throw Error("useLGA must be used within an LGAProvider");return e}},94446:(e,a,t)=>{"use strict";t.d(a,{s:()=>s,t:()=>n});var r=t(12115);function l(e,a){if("function"==typeof e)return e(a);null!=e&&(e.current=a)}function n(...e){return a=>{let t=!1,r=e.map(e=>{let r=l(e,a);return t||"function"!=typeof r||(t=!0),r});if(t)return()=>{for(let a=0;a<r.length;a++){let t=r[a];"function"==typeof t?t():l(e[a],null)}}}}function s(...e){return r.useCallback(n(...e),e)}},97003:(e,a,t)=>{"use strict";t.d(a,{$:()=>o});var r=t(95155);t(12115);var l=t(32467),n=t(83101),s=t(25016);let i=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function o(e){let{className:a,variant:t,size:n,asChild:o=!1,...c}=e,d=o?l.DX:"button";return(0,r.jsx)(d,{"data-slot":"button",className:(0,s.cn)(i({variant:t,size:n,className:a})),...c})}}},e=>{e.O(0,[125,779,441,255,358],()=>e(e.s=22393)),_N_E=e.O()}]);