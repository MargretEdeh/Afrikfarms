(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[252],{6132:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},12862:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let a=r(95125).A.create({baseURL:"https://backend-api.afrikfarm.com/api/v1",headers:{"Content-Type":"application/json"}});a.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e});let s=a},13396:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var a=r(95155),s=r(12115),o=r(17910),l=r(61362),n=r(6132);let i=(0,r(71847).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var c=r(23664),d=r(99708),u=r(49730);function m(){let{registerSuperAdmin:e}=(0,u.A)(),[t,r]=(0,s.useState)(null),[m,h]=(0,s.useState)(!1),[g,p]=(0,s.useState)({fullname:"",email:"",password:"",confirmPassword:""}),x=async()=>{if(r(null),!g.fullname||!g.email||!g.password)return void r({type:"error",text:"All fields are required"});if(g.password!==g.confirmPassword)return void r({type:"error",text:"Passwords do not match"});if(g.password.length<6)return void r({type:"error",text:"Password must be at least 6 characters"});h(!0);try{await e({fullname:g.fullname,email:g.email,password:g.password}),r({type:"success",text:"Super Admin registered successfully!"}),p({fullname:"",email:"",password:"",confirmPassword:""})}catch(t){let e="Registration failed. Please try again.";t instanceof Error?e=t.message:"string"==typeof t&&(e=t),r({type:"error",text:e})}finally{h(!1)}},f=e=>{"Enter"!==e.key||m||x()};return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-green-50 via-amber-50 to-yellow-50 flex items-center justify-center p-6",children:(0,a.jsxs)("div",{className:"w-full max-w-md",children:[(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl overflow-hidden",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-green-800 to-amber-600 p-8 text-white",children:[(0,a.jsx)("div",{className:"flex items-center justify-center mb-4",children:(0,a.jsx)("div",{className:"bg-white/20 p-4 rounded-full",children:(0,a.jsx)(o.A,{className:"w-10 h-10"})})}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-center",children:"Register Super Admin"}),(0,a.jsx)("p",{className:"text-green-100 mt-2 text-center",children:"Create your administrator account"})]}),(0,a.jsxs)("div",{className:"p-8",children:[t&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 p-4 rounded-lg mb-6 ".concat("success"===t.type?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"),children:["success"===t.type?(0,a.jsx)(l.A,{className:"w-5 h-5 flex-shrink-0"}):(0,a.jsx)(n.A,{className:"w-5 h-5 flex-shrink-0"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:t.text})]}),(0,a.jsxs)("div",{className:"space-y-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Full Name"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(i,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,a.jsx)("input",{type:"text",value:g.fullname,onChange:e=>p({...g,fullname:e.target.value}),onKeyPress:f,className:"w-full pl-11 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-800 focus:border-transparent transition-all",placeholder:"Super Admin"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Email Address"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(c.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,a.jsx)("input",{type:"email",value:g.email,onChange:e=>p({...g,email:e.target.value}),onKeyPress:f,className:"w-full pl-11 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",placeholder:"super.admin@example.com"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Password"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(d.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,a.jsx)("input",{type:"password",value:g.password,onChange:e=>p({...g,password:e.target.value}),onKeyPress:f,className:"w-full pl-11 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",placeholder:"••••••••"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Confirm Password"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(d.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,a.jsx)("input",{type:"password",value:g.confirmPassword,onChange:e=>p({...g,confirmPassword:e.target.value}),onKeyPress:f,className:"w-full pl-11 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",placeholder:"••••••••"})]})]}),(0,a.jsx)("button",{onClick:x,disabled:m,className:"w-full px-6 py-3 bg-gradient-to-r from-green-800 to-amber-600 text-white rounded-lg hover:from-green-900 hover:to-amber-700 transition-all font-semibold disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:m?(0,a.jsxs)("span",{className:"flex items-center justify-center",children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Registering..."]}):"Register Super Admin"})]}),(0,a.jsx)("div",{className:"mt-6 text-center",children:(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",(0,a.jsx)("button",{className:"text-green-800 font-semibold hover:text-green-900 transition-colors",children:"Sign In"})]})})]})]}),(0,a.jsx)("div",{className:"mt-6 text-center text-sm text-gray-600",children:(0,a.jsx)("p",{children:"\xa9 2024 Admin Portal. All rights reserved."})})]})})}},17910:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},18323:(e,t,r)=>{"use strict";r.d(t,{u:()=>s});var a=r(12862);let s={loginAdmin:async(e,t)=>(await a.A.post("/auth/admin-login",{email:e,password:t})).data,loginUser:async(e,t)=>(await a.A.post("/auth/login",{login_id:e,password:t})).data,registerSuperAdmin:async e=>(await a.A.post("/auth/admin-register",e)).data,createUser:async e=>(await a.A.post("/admin/create-user",e)).data,getProfile:async()=>(await a.A.get("/auth/me")).data,getCountries:async()=>(await a.A.get("/admin/countries")).data,getStates:async()=>(await a.A.get("/admin/states")).data,getLgas:async()=>(await a.A.get("/admin/lgas")).data,logout:async()=>(await a.A.post("/auth/admin-logout")).data}},20063:(e,t,r)=>{"use strict";var a=r(47260);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},23664:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])},49730:(e,t,r)=>{"use strict";r.d(t,{A:()=>m,AuthProvider:()=>u});var a=r(95155),s=r(12115),o=r(20063),l=r(18323),n=r(99776);function i(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:7,a=new Date(Date.now()+864e5*r).toUTCString();document.cookie="".concat(e,"=").concat(encodeURIComponent(t),"; expires=").concat(a,"; path=/; SameSite=Strict")}function c(e){document.cookie="".concat(e,"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; SameSite=Strict")}let d=(0,s.createContext)(void 0),u=e=>{let{children:t}=e,[r,u]=(0,s.useState)(null),[m,h]=(0,s.useState)(!0),g=(0,n.jE)(),p=(0,o.useRouter)();(0,s.useEffect)(()=>{let e=localStorage.getItem("user"),t=function(e){let t="; ".concat(document.cookie).split("; ".concat(e,"="));if(2===t.length){var r;return decodeURIComponent((null==(r=t.pop())?void 0:r.split(";").shift())||"")}return null}("token");e&&t&&u(JSON.parse(e)),h(!1)},[]);let x=async(e,t,r)=>{let a="admin"===r?await l.u.loginAdmin(e,t):await l.u.loginUser(e,t);console.log("Raw login response:",a);let s=a.user||a.admin,o={...s,token:a.token};u(o),localStorage.setItem("token",a.token),localStorage.setItem("user",JSON.stringify(o)),i("token",a.token,7);let n=null==s?void 0:s.role;switch(console.log("User role for routing:",n),i("role",n,7),n){case"lga_admin":default:p.push("/dashboard");break;case"super_admin":p.push("/admin/dashboard");break;case"state_admin":p.push("/state/dashboard")}},f=async e=>{let t=await l.u.registerSuperAdmin(e),r={...t.admin||t.newAdmin,token:t.token};u(r),localStorage.setItem("token",t.token),localStorage.setItem("user",JSON.stringify(r)),i("token",t.token,7),p.push("/admin/dashboard")},y=async e=>{await l.u.createUser(e)},w=async()=>{try{await l.u.logout()}catch(e){console.error("Error during server logout:",e)}try{localStorage.clear()}catch(e){console.error("Error clearing localStorage:",e),localStorage.removeItem("token"),localStorage.removeItem("user")}try{!function(){for(let e of document.cookie.split(";")){let t=e.indexOf("="),r=t>-1?e.substr(0,t).trim():e.trim();r&&(document.cookie="".concat(r,"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; SameSite=Strict"))}}()}catch(e){console.error("Error clearing cookies:",e),c("token"),c("role")}g.clear(),u(null);try{p.push("/login")}catch(e){window.location.href="/login"}};return(0,a.jsx)(d.Provider,{value:{user:r,loading:m,login:x,logout:w,registerSuperAdmin:f,createUser:async e=>await y(e)},children:t})},m=()=>{let e=(0,s.useContext)(d);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},61362:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},64510:(e,t,r)=>{Promise.resolve().then(r.bind(r,13396))},71847:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var a=r(12115);let s=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},o=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:s=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:c="",children:d,iconNode:u,...m}=e;return(0,a.createElement)("svg",{ref:t,...l,width:s,height:s,stroke:r,strokeWidth:i?24*Number(n)/Number(s):n,className:o("lucide",c),...!d&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(m)&&{"aria-hidden":"true"},...m},[...u.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),i=(e,t)=>{let r=(0,a.forwardRef)((r,l)=>{let{className:i,...c}=r;return(0,a.createElement)(n,{ref:l,iconNode:t,className:o("lucide-".concat(s(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),i),...c})});return r.displayName=s(e),r}},99708:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},99776:(e,t,r)=>{"use strict";r.d(t,{Ht:()=>n,jE:()=>l});var a=r(12115),s=r(95155),o=a.createContext(void 0),l=e=>{let t=a.useContext(o);if(e)return e;if(!t)throw Error("No QueryClient set, use QueryClientProvider to set one");return t},n=e=>{let{client:t,children:r}=e;return a.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),(0,s.jsx)(o.Provider,{value:t,children:r})}}},e=>{e.O(0,[125,441,255,358],()=>e(e.s=64510)),_N_E=e.O()}]);