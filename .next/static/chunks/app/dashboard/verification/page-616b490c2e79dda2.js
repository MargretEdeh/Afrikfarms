(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[69],{12862:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let r=t(95125).A.create({baseURL:"https://backend-api.afrikfarm.com/api/v1",headers:{"Content-Type":"application/json"}});r.interceptors.request.use(e=>{let a=localStorage.getItem("token");return a&&(e.headers.Authorization="Bearer ".concat(a)),e});let s=r},25016:(e,a,t)=>{"use strict";t.d(a,{cn:()=>n});var r=t(2821),s=t(75889);function n(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return(0,s.QP)((0,r.$)(a))}},33789:(e,a,t)=>{"use strict";t.d(a,{p:()=>n});var r=t(95155);t(12115);var s=t(25016);function n(e){let{className:a,type:t,...n}=e;return(0,r.jsx)("input",{type:t,"data-slot":"input",className:(0,s.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",a),...n})}},48465:(e,a,t)=>{"use strict";t.d(a,{_:()=>s});var r=t(12862);let s={getDashboard:async()=>(await r.A.get("/lga/dashboard")).data,createFarmer:async e=>(await r.A.post("/lga/create-farmer",e)).data,getFarmers:async()=>(await r.A.get("/lga/farmers")).data,getFarmerById:async e=>(await r.A.get("/lga/farmers/".concat(e))).data,sendCode:async e=>(await r.A.post("/lga/send-code",e)).data,verifyCode:async e=>(await r.A.post("/lga/verify-code",e)).data,verifyNin:async e=>(await r.A.post("/lga/verify-nin",e)).data,uploadProfileImage:async(e,a)=>(await r.A.post("/lga/upload-profile-image",e,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:a})).data,UploadProofOfAddress:async(e,a)=>(await r.A.post("/lga/upload-proof-of-address",e,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:a})).data,getBanks:async()=>(await r.A.get("/banks")).data,getAccountName:async e=>(await r.A.get("/get-account-name",{params:{bank_code:e.bankCode,account_number:e.accountNumber}})).data,updateFarmer:async(e,a)=>(await r.A.put("/lga/farmers/".concat(e),a)).data,deleteFarmer:async e=>(await r.A.delete("/lga/farmers/".concat(e))).data,getFarms:async()=>(await r.A.get("/lga/farms")).data,createFarm:async e=>(await r.A.post("/lga/create-farm",e)).data,deleteFarm:async e=>(await r.A.delete("/lga/delete-farm?farm_id=".concat(e))).data,updateFarm:async(e,a)=>(await r.A.put("/lga/update-farm?farm_id=".concat(e),a)).data,getFarmById:async e=>(await r.A.get("/lga/get-farm?farm_id=".concat(e))).data,getFarmersFarms:async e=>(await r.A.get("/lga/farmers-farms?farmer_id=".concat(e))).data,initializePayment:async e=>{console.log("=== PAYMENT INITIALIZATION DEBUG ==="),console.log("1. Data received by service:",e),console.log("2. Data stringified:",JSON.stringify(e));try{let a=await r.A.post("/lga/initialize-payment",e);return console.log("3. Full response received:",a),console.log("4. Response data:",a.data),a.data}catch(e){var a,t;throw console.error("4. Error caught in service:",e),console.error("5. Error response data:",null==(a=e.response)?void 0:a.data),console.error("6. Error request data:",null==(t=e.config)?void 0:t.data),e}},verifyPayment:async(e,a)=>(await r.A.get("/lga/verify-payment?trxref=".concat(e,"&reference=").concat(a))).data}},54679:(e,a,t)=>{"use strict";t.d(a,{Cf:()=>c,L3:()=>m,c7:()=>u,lG:()=>i});var r=t(95155);t(12115);var s=t(89511),n=t(65229),l=t(25016);function i(e){let{...a}=e;return(0,r.jsx)(s.bL,{"data-slot":"dialog",...a})}function d(e){let{...a}=e;return(0,r.jsx)(s.ZL,{"data-slot":"dialog-portal",...a})}function o(e){let{className:a,...t}=e;return(0,r.jsx)(s.hJ,{"data-slot":"dialog-overlay",className:(0,l.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),...t})}function c(e){let{className:a,children:t,showCloseButton:i=!0,...c}=e;return(0,r.jsxs)(d,{"data-slot":"dialog-portal",children:[(0,r.jsx)(o,{}),(0,r.jsxs)(s.UC,{"data-slot":"dialog-content",className:(0,l.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",a),...c,children:[t,i&&(0,r.jsxs)(s.bm,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,r.jsx)(n.A,{}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function u(e){let{className:a,...t}=e;return(0,r.jsx)("div",{"data-slot":"dialog-header",className:(0,l.cn)("flex flex-col gap-2 text-center sm:text-left",a),...t})}function m(e){let{className:a,...t}=e;return(0,r.jsx)(s.hE,{"data-slot":"dialog-title",className:(0,l.cn)("text-lg leading-none font-semibold",a),...t})}},71061:(e,a,t)=>{Promise.resolve().then(t.bind(t,99205))},83209:(e,a,t)=>{"use strict";t.d(a,{BT:()=>d,Wu:()=>o,ZB:()=>i,Zp:()=>n,aR:()=>l});var r=t(95155);t(12115);var s=t(25016);function n(e){let{className:a,...t}=e;return(0,r.jsx)("div",{"data-slot":"card",className:(0,s.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",a),...t})}function l(e){let{className:a,...t}=e;return(0,r.jsx)("div",{"data-slot":"card-header",className:(0,s.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",a),...t})}function i(e){let{className:a,...t}=e;return(0,r.jsx)("div",{"data-slot":"card-title",className:(0,s.cn)("leading-none font-semibold",a),...t})}function d(e){let{className:a,...t}=e;return(0,r.jsx)("div",{"data-slot":"card-description",className:(0,s.cn)("text-muted-foreground text-sm",a),...t})}function o(e){let{className:a,...t}=e;return(0,r.jsx)("div",{"data-slot":"card-content",className:(0,s.cn)("px-6",a),...t})}},90235:(e,a,t)=>{"use strict";t.d(a,{J:()=>l});var r=t(95155);t(12115);var s=t(10489),n=t(25016);function l(e){let{className:a,...t}=e;return(0,r.jsx)(s.b,{"data-slot":"label",className:(0,n.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",a),...t})}},92850:(e,a,t)=>{"use strict";t.d(a,{LGAProvider:()=>i,e:()=>d});var r=t(95155),s=t(12115),n=t(48465);let l=(0,s.createContext)(void 0),i=e=>{let{children:a}=e,[t,i]=(0,s.useState)([]),[d,o]=(0,s.useState)([]),[c,u]=(0,s.useState)(null),[m,g]=(0,s.useState)(!1),[f,p]=(0,s.useState)(null),x=(0,s.useCallback)(()=>p(null),[]),h=(0,s.useCallback)(async()=>{g(!0),p(null);try{let e=await n._.getDashboard();u(e)}catch(t){var e,a;throw p((null==(a=t.response)||null==(e=a.data)?void 0:e.message)||"Failed to fetch dashboard data"),t}finally{g(!1)}},[]),v=(0,s.useCallback)(async()=>{g(!0),p(null);try{let e=await n._.getFarmers(),a=(null==e?void 0:e.data)||[];i(a)}catch(t){var e,a;throw p((null==(a=t.response)||null==(e=a.data)?void 0:e.message)||"Failed to fetch farmers"),t}finally{g(!1)}},[]),y=(0,s.useCallback)(async e=>{g(!0),p(null);try{let a=await n._.getFarmerById(e);return a.farmer||a}catch(e){var a,t;throw p((null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to fetch farmer"),e}finally{g(!1)}},[]),b=(0,s.useCallback)(async e=>{g(!0),p(null);try{let a=await n._.createFarmer(e);return await v(),a}catch(e){var a,t;throw p((null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to create farmer"),e}finally{g(!1)}},[v]),j=(0,s.useCallback)(async(e,a)=>{g(!0),p(null);try{await n._.updateFarmer(e,a),await v()}catch(e){var t,r;throw p((null==(r=e.response)||null==(t=r.data)?void 0:t.message)||"Failed to update farmer"),e}finally{g(!1)}},[v]),w=(0,s.useCallback)(async e=>{g(!0),p(null);try{await n._.deleteFarmer(e),i(a=>a.filter(a=>a.id!==e))}catch(e){var a,t;throw p((null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to delete farmer"),e}finally{g(!1)}},[]),N=(0,s.useCallback)(async()=>{g(!0),p(null);try{let e=await n._.getFarms(),a=e.data||e.farms||e||[];o(Array.isArray(a)?a:[])}catch(t){var e,a;throw p((null==(a=t.response)||null==(e=a.data)?void 0:e.message)||"Failed to fetch farms"),o([]),t}finally{g(!1)}},[]),k=(0,s.useCallback)(async e=>{g(!0),p(null);try{let a=await n._.getFarmById(e);return a.farm||a}catch(e){var a,t;throw p((null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to fetch farm"),e}finally{g(!1)}},[]),A=(0,s.useCallback)(async e=>{g(!0),p(null);try{let a=await n._.getFarmersFarms(e);return a.farms||a}catch(e){var a,t;throw p((null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to fetch farmer farms"),e}finally{g(!1)}},[]),F=(0,s.useCallback)(async e=>{g(!0),p(null);try{let a=await n._.createFarm(e);return await N(),a}catch(e){var a,t;throw p((null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to create farm"),e}finally{g(!1)}},[N]),C=(0,s.useCallback)(async(e,a)=>{g(!0),p(null);try{await n._.updateFarm(e,a),await N()}catch(e){var t,r;throw p((null==(r=e.response)||null==(t=r.data)?void 0:t.message)||"Failed to update farm"),e}finally{g(!1)}},[N]),_=(0,s.useCallback)(async e=>{g(!0),p(null);try{await n._.deleteFarm(e),o(a=>a.filter(a=>a.id!==e))}catch(e){var a,t;throw p((null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to delete farm"),e}finally{g(!1)}},[]),S=(0,s.useCallback)(async e=>{g(!0),p(null);try{return await n._.sendCode(e)}catch(e){var a,t;throw p((null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to send code"),e}finally{g(!1)}},[]),P=(0,s.useCallback)(async e=>{g(!0),p(null);try{return await n._.verifyCode(e)}catch(e){var a,t;throw p((null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to verify code"),e}finally{g(!1)}},[]),z=(0,s.useCallback)(async e=>{g(!0),p(null);try{return await n._.verifyNin(e)}catch(e){var a,t;throw p((null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to verify NIN"),e}finally{g(!1)}},[]),I=(0,s.useCallback)(async e=>{g(!0),p(null);try{return await n._.initializePayment(e)}catch(e){var a,t;throw p((null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to initialize payment"),e}finally{g(!1)}},[]),E=(0,s.useCallback)(async(e,a)=>{g(!0),p(null);try{return await n._.verifyPayment(e,a)}catch(e){var t,r;throw p((null==(r=e.response)||null==(t=r.data)?void 0:t.message)||"Failed to verify payment"),e}finally{g(!1)}},[]);return(0,r.jsx)(l.Provider,{value:{farmers:t,farms:d,dashboard:c,loading:m,error:f,fetchDashboard:h,fetchFarmers:v,getFarmerById:y,createFarmer:b,updateFarmer:j,deleteFarmer:w,fetchFarms:N,getFarmById:k,getFarmersFarms:A,createFarm:F,updateFarm:C,deleteFarm:_,sendCode:S,verifyCode:P,verifyNin:z,initailizePayment:I,verifyPayment:E,clearError:x},children:a})},d=()=>{let e=(0,s.useContext)(l);if(!e)throw Error("useLGA must be used within an LGAProvider");return e}},97003:(e,a,t)=>{"use strict";t.d(a,{$:()=>d});var r=t(95155);t(12115);var s=t(32467),n=t(83101),l=t(25016);let i=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function d(e){let{className:a,variant:t,size:n,asChild:d=!1,...o}=e,c=d?s.DX:"button";return(0,r.jsx)(c,{"data-slot":"button",className:(0,l.cn)(i({variant:t,size:n,className:a})),...o})}},99205:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>z});var r=t(95155),s=t(12115),n=t(97003),l=t(83209),i=t(32467),d=t(83101),o=t(25016);let c=(0,d.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function u(e){let{className:a,variant:t,asChild:s=!1,...n}=e,l=s?i.DX:"span";return(0,r.jsx)(l,{"data-slot":"badge",className:(0,o.cn)(c({variant:t}),a),...n})}var m=t(33789),g=t(35299),f=t(91169),p=t(61362),x=t(26983),h=t(1524),v=t(86651),y=t(6132),b=t(78519),j=t(54679),w=t(90235),N=t(40773),k=t(99051);function A(e){let{className:a,...t}=e;return(0,r.jsx)(N.bL,{"data-slot":"radio-group",className:(0,o.cn)("grid gap-3",a),...t})}function F(e){let{className:a,...t}=e;return(0,r.jsx)(N.q7,{"data-slot":"radio-group-item",className:(0,o.cn)("border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",a),...t,children:(0,r.jsx)(N.C1,{"data-slot":"radio-group-indicator",className:"relative flex items-center justify-center",children:(0,r.jsx)(k.A,{className:"fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2"})})})}var C=t(92850);function _(e){let{open:a,onClose:t,farmerName:i,farmerId:d,farmerEmail:o}=e,{initailizePayment:c}=(0,C.e)(),[u,f]=(0,s.useState)("paystack"),[p,x]=(0,s.useState)(""),[h,v]=(0,s.useState)(!1),[N,k]=(0,s.useState)(null),_=async()=>{var e,a,t,r,s;if(!p||0>=Number.parseFloat(p))return void k("Please enter a valid amount");v(!0),k(null);try{let a={farmer_id:Number.parseInt(d),amount:Number.parseFloat(p)};console.log("Initializing payment with data:",a);let t=await c(a);console.log("Payment init response:",t);let r=(null==t||null==(e=t.data)?void 0:e.data)||(null==t?void 0:t.data)||t;if(!(null==r?void 0:r.authorization_url)||!(null==r?void 0:r.reference))throw console.error("Missing payment data:",r),console.error("Full response:",t),Error((null==t?void 0:t.message)||"Failed to initialize payment - missing authorization URL");let{authorization_url:s,reference:n}=r;console.log("Redirecting to:",s),console.log("Payment reference:",n),localStorage.setItem("paystack_ref",n),localStorage.setItem("payment_amount",p),localStorage.setItem("farmer_id",d),window.location.href=s}catch(e){console.error("Payment initialization error:",e),k((null==(t=e.response)||null==(a=t.data)?void 0:a.message)||(null==(s=e.response)||null==(r=s.data)?void 0:r.error)||e.message||"Failed to initialize payment"),v(!1)}},S=async()=>{if(!p||0>=Number.parseFloat(p))return void k("Please enter a valid amount");v(!0),k(null),await new Promise(e=>setTimeout(e,2e3)),v(!1),t()},P=()=>{h||(x(""),k(null),v(!1),t())};return(0,r.jsx)(j.lG,{open:a,onOpenChange:P,children:(0,r.jsxs)(j.Cf,{className:"max-w-md",children:[(0,r.jsx)(j.c7,{children:(0,r.jsxs)(j.L3,{children:["Process Payment for ",i]})}),(0,r.jsxs)("div",{className:"space-y-6",children:[N&&(0,r.jsxs)("div",{className:"flex items-center gap-2 bg-red-50 p-3 border border-red-200 rounded-md",children:[(0,r.jsx)(y.A,{className:"text-red-600 h-5 w-5 flex-shrink-0"}),(0,r.jsx)("p",{className:"text-red-600 text-sm",children:N})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(w.J,{htmlFor:"amount",children:"Payment Amount (₦)"}),(0,r.jsx)(m.p,{id:"amount",type:"number",placeholder:"Enter amount",value:p,onChange:e=>{x(e.target.value),k(null)},min:"0",step:"0.01",disabled:h}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Enter the amount to pay for this farmer"})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(w.J,{children:"Select Payment Method"}),(0,r.jsx)(A,{value:u,onValueChange:e=>f(e),disabled:h,children:(0,r.jsx)(l.Zp,{className:"cursor-pointer p-4 transition-colors ".concat("paystack"===u?"border-primary bg-primary/5":""," ").concat(h?"opacity-50 cursor-not-allowed":""),children:(0,r.jsxs)("label",{className:"flex cursor-pointer items-center gap-3",children:[(0,r.jsx)(F,{value:"paystack",id:"paystack",disabled:h}),(0,r.jsx)(b.A,{className:"h-5 w-5 text-muted-foreground"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("div",{className:"font-medium",children:"Paystack"}),(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Pay with card, bank transfer, or USSD"})]})]})})})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(n.$,{variant:"outline",onClick:P,disabled:h,className:"flex-1 bg-transparent",children:"Cancel"}),(0,r.jsx)(n.$,{onClick:()=>{"paystack"===u?_():S()},disabled:h||!p||0>=Number.parseFloat(p),className:"flex-1",children:h?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Redirecting..."]}):"Pay ".concat(p?"₦".concat(Number.parseFloat(p).toLocaleString()):"Amount")})]})]})]})})}var S=t(52619),P=t.n(S);function z(){let{farmers:e,loading:a,error:t,fetchFarmers:i}=(0,C.e)(),[d,o]=(0,s.useState)([]),[c,j]=(0,s.useState)(""),[w,N]=(0,s.useState)(null),[k,A]=(0,s.useState)(!1),[F,S]=(0,s.useState)(null);(0,s.useEffect)(()=>{(async()=>{try{await i()}catch(e){S(e.message||"Failed to load farmers")}})()},[i]),(0,s.useEffect)(()=>{if(console.log("Context farmers:",e),e){let a=Array.isArray(e)?e:(null==e?void 0:e.data)||[];console.log("Farmers array:",a),a.length>0?o(a.map(e=>({...e,paymentStatus:e.has_paid?"success":"pending",paymentAmount:e.payment_amount||0}))):o([])}},[e]);let z=d.filter(e=>e.fullname.toLowerCase().includes(c.toLowerCase())||String(e.id).includes(c)||e.phone_number.includes(c)),I=d.length,E=d.filter(e=>"success"===e.paymentStatus).length,L=d.filter(e=>"pending"===e.paymentStatus).length,Z=d.filter(e=>"success"===e.paymentStatus).reduce((e,a)=>e+(a.paymentAmount||0),0);return a?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,r.jsx)(g.A,{className:"w-10 h-10 animate-spin text-primary"})}):(0,r.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"grid md:grid-cols-4 gap-6 mb-8",children:[(0,r.jsxs)(l.Zp,{children:[(0,r.jsxs)(l.aR,{className:"flex justify-between items-center",children:[(0,r.jsx)(l.ZB,{children:"Total Farmers"}),(0,r.jsx)(f.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsx)(l.Wu,{children:(0,r.jsx)("div",{className:"text-2xl font-bold",children:I})})]}),(0,r.jsxs)(l.Zp,{children:[(0,r.jsxs)(l.aR,{className:"flex justify-between items-center",children:[(0,r.jsx)(l.ZB,{children:"Paid"}),(0,r.jsx)(p.A,{className:"h-4 w-4 text-green-600"})]}),(0,r.jsx)(l.Wu,{children:(0,r.jsx)("div",{className:"text-2xl font-bold",children:E})})]}),(0,r.jsxs)(l.Zp,{children:[(0,r.jsxs)(l.aR,{className:"flex justify-between items-center",children:[(0,r.jsx)(l.ZB,{children:"Unpaid"}),(0,r.jsx)(x.A,{className:"h-4 w-4 text-orange-600"})]}),(0,r.jsx)(l.Wu,{children:(0,r.jsx)("div",{className:"text-2xl font-bold",children:L})})]}),(0,r.jsxs)(l.Zp,{children:[(0,r.jsxs)(l.aR,{className:"flex justify-between items-center",children:[(0,r.jsx)(l.ZB,{children:"Total Revenue"}),(0,r.jsx)(h.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsx)(l.Wu,{children:(0,r.jsxs)("div",{className:"text-2xl font-bold",children:["₦",Z.toLocaleString()]})})]})]}),(0,r.jsxs)(l.Zp,{children:[(0,r.jsxs)(l.aR,{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)(l.ZB,{children:"Farmers Management"}),(0,r.jsx)(n.$,{children:(0,r.jsxs)(P(),{className:"flex items-center",href:"/dashboard/farmers",children:[(0,r.jsx)(f.A,{className:"mr-2 h-4 w-4"})," Add New Farmer"]})})]}),(0,r.jsxs)("div",{className:"relative mt-4",children:[(0,r.jsx)(v.A,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,r.jsx)(m.p,{placeholder:"Search by name, ID, or phone...",value:c,onChange:e=>j(e.target.value),className:"pl-10"})]})]}),(0,r.jsxs)(l.Wu,{children:[(F||t)&&(0,r.jsxs)("div",{className:"flex items-center gap-2 bg-red-50 p-3 border border-red-200 rounded-md mb-4",children:[(0,r.jsx)(y.A,{className:"text-red-600 h-5 w-5"}),(0,r.jsx)("p",{className:"text-red-600 text-sm",children:F||t})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[z.map(e=>(0,r.jsx)(l.Zp,{children:(0,r.jsxs)("div",{className:"p-4 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[(0,r.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,r.jsx)("h3",{className:"font-semibold",children:e.fullname}),(0,r.jsx)(u,{variant:(e=>{switch(null==e?void 0:e.toLowerCase()){case"active":return"default";case"pending":default:return"secondary";case"inactive":return"outline";case"suspended":return"destructive"}})(e.status),children:e.status||"pending"}),(0,r.jsx)(u,{className:"success"===e.paymentStatus?"bg-green-100 text-green-800 border-green-200":"bg-orange-100 text-orange-800 border-orange-200",children:"success"===e.paymentStatus?"Paid":"Unpaid"})]}),(0,r.jsxs)("div",{className:"grid sm:grid-cols-2 gap-1 text-sm text-muted-foreground",children:[(0,r.jsxs)("div",{children:["ID: ",e.id]}),(0,r.jsxs)("div",{children:["Phone: ",e.phone_number]}),(0,r.jsxs)("div",{children:["Email: ",e.email||"N/A"]}),(0,r.jsxs)("div",{children:["Address: ",e.address]})]})]}),(0,r.jsx)("div",{children:"pending"===e.paymentStatus?(0,r.jsxs)(n.$,{onClick:()=>{N(e),A(!0)},children:[(0,r.jsx)(b.A,{className:"mr-2 h-4 w-4"})," Pay"]}):(0,r.jsxs)("div",{className:"flex items-center gap-2 text-green-600 bg-green-50 px-4 py-2 rounded-md",children:[(0,r.jsx)(p.A,{className:"h-5 w-5"})," Paid"]})})]})},e.id)),0===z.length&&(0,r.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,r.jsx)(f.A,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),(0,r.jsx)("p",{children:"No farmers found."})]})]})]})]})]}),w&&(0,r.jsx)(_,{open:k,onClose:()=>{A(!1),N(null)},onSuccess:e=>{w&&o(a=>a.map(a=>a.id===w.id?{...a,paymentStatus:"success",paymentAmount:e.amount,payment_reference:e.reference}:a)),A(!1),N(null)},farmerName:w.fullname,farmerId:String(w.id),farmerEmail:w.email||""})]})}}},e=>{e.O(0,[125,779,411,758,127,893,375,441,255,358],()=>e(e.s=71061)),_N_E=e.O()}]);