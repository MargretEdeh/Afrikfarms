(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[910],{14092:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>k});var r=s(95155),t=s(12115),l=s(66955),n=s(35299),i=s(80501),d=s(6191),c=s(18720),o=s(22033),m=s(83685),u=s(68063),x=s(24958),h=s(65229),g=s(78874),f=s(42529),p=s(69141),y=s(23664),b=s(21873),j=s(89715),v=s(71871),N=s(78519);function w(e){let{farmerId:a,open:s,onClose:l}=e,[i,d]=(0,t.useState)(null),[c,m]=(0,t.useState)(!1),[u,x]=(0,t.useState)(null),{getFarmerById:w}=(0,o.z)();(0,t.useEffect)(()=>{s&&a?A():(d(null),x(null))},[s,a]);let A=async()=>{if(a){m(!0),x(null);try{let e=parseInt(a.replace(/\D/g,"")),s=await w(e),r=(null==s?void 0:s.data)||s;d(r)}catch(a){var e,s;x((null==a||null==(s=a.response)||null==(e=s.data)?void 0:e.message)||(null==a?void 0:a.message)||"Failed to load farmer details"),console.error("Failed to fetch farmer:",a)}finally{m(!1)}}};return s?(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Farmer Details"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Complete farmer profile information"})]}),(0,r.jsx)("button",{onClick:l,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Close modal",children:(0,r.jsx)(h.A,{className:"w-6 h-6 text-gray-500"})})]}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:c?(0,r.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(n.A,{className:"w-12 h-12 animate-spin text-primary mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-500",children:"Loading farmer details..."})]})}):u?(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-8 text-center",children:[(0,r.jsx)(g.A,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-red-900 mb-2",children:"Failed to Load Details"}),(0,r.jsx)("p",{className:"text-sm text-red-600",children:u}),(0,r.jsx)("button",{onClick:A,className:"mt-4 px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors",children:"Try Again"})]}):i?(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"bg-gradient-to-br from-primary to-emerald-500 rounded-xl p-6 text-white",children:(0,r.jsxs)("div",{className:"flex items-start gap-6",children:[(0,r.jsx)("div",{className:"w-24 h-24 rounded-full bg-white/20 flex items-center justify-center text-3xl font-bold backdrop-blur-sm",children:i.profile_image&&"noimage.jpg"!==i.profile_image?(0,r.jsx)("img",{src:i.profile_image,alt:i.fullname,className:"w-full h-full rounded-full object-cover"}):i.fullname.split(" ").map(e=>e[0]).join("")}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-2xl font-bold mb-2",children:i.fullname}),(0,r.jsxs)("p",{className:"text-white/80 text-sm",children:["Farmer ID: FRM",String(i.id).padStart(4,"0")]})]}),(0,r.jsx)("span",{className:"px-4 py-2 rounded-full text-sm font-semibold ".concat((e=>{switch(e.toLowerCase()){case"active":return"bg-green-100 text-green-700";case"pending":return"bg-amber-100 text-amber-700";case"inactive":default:return"bg-gray-100 text-gray-700";case"suspended":return"bg-red-100 text-red-700"}})(i.status)),children:i.status})]}),(0,r.jsxs)("div",{className:"mt-4 flex items-center gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[i.phone_verified?(0,r.jsx)(f.A,{className:"w-5 h-5"}):(0,r.jsx)(g.A,{className:"w-5 h-5"}),(0,r.jsxs)("span",{className:"text-sm",children:["Phone ",i.phone_verified?"Verified":"Not Verified"]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[i.nin_verified?(0,r.jsx)(f.A,{className:"w-5 h-5"}):(0,r.jsx)(g.A,{className:"w-5 h-5"}),(0,r.jsxs)("span",{className:"text-sm",children:["NIN ",i.nin_verified?"Verified":"Not Verified"]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[i.has_paid?(0,r.jsx)(f.A,{className:"w-5 h-5"}):(0,r.jsx)(g.A,{className:"w-5 h-5"}),(0,r.jsx)("span",{className:"text-sm",children:i.has_paid?"Paid":"Not Paid"})]})]})]})]})}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6",children:[(0,r.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Contact Information"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(p.A,{className:"w-5 h-5 text-gray-400 mt-0.5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Phone Number"}),(0,r.jsx)("p",{className:"text-gray-900 font-medium",children:i.phone_number})]})]}),i.email&&(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(y.A,{className:"w-5 h-5 text-gray-400 mt-0.5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Email Address"}),(0,r.jsx)("p",{className:"text-gray-900 font-medium break-all",children:i.email})]})]}),(0,r.jsxs)("div",{className:"flex items-start gap-3 md:col-span-2",children:[(0,r.jsx)(b.A,{className:"w-5 h-5 text-gray-400 mt-0.5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Address"}),(0,r.jsx)("p",{className:"text-gray-900 font-medium",children:i.address})]})]})]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6",children:[(0,r.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Identification"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(j.A,{className:"w-5 h-5 text-gray-400 mt-0.5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"National ID Number (NIN)"}),(0,r.jsx)("p",{className:"text-gray-900 font-medium font-mono",children:i.nin})]})]}),i.proof_of_address&&"noimage.jpg"!==i.proof_of_address&&(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(j.A,{className:"w-5 h-5 text-gray-400 mt-0.5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Proof of Address"}),(0,r.jsx)("a",{href:i.proof_of_address,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline font-medium",children:"View Document"})]})]})]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6",children:[(0,r.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Banking Information"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(v.A,{className:"w-5 h-5 text-gray-400 mt-0.5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Account Name"}),(0,r.jsx)("p",{className:"text-gray-900 font-medium",children:i.account_name})]})]}),(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(N.A,{className:"w-5 h-5 text-gray-400 mt-0.5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Account Number"}),(0,r.jsx)("p",{className:"text-gray-900 font-medium font-mono",children:i.account_number})]})]}),(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(v.A,{className:"w-5 h-5 text-gray-400 mt-0.5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Bank ID"}),(0,r.jsx)("p",{className:"text-gray-900 font-medium",children:i.bankId})]})]})]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6",children:[(0,r.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"System Information"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Registration Date"}),(0,r.jsx)("p",{className:"text-gray-900 font-medium",children:new Date(i.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Last Updated"}),(0,r.jsx)("p",{className:"text-gray-900 font-medium",children:new Date(i.updatedAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Account Created By"}),(0,r.jsxs)("p",{className:"text-gray-900 font-medium",children:["Admin ID: ",i.account_created_by]})]})]})]})]}):null}),(0,r.jsx)("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:(0,r.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,r.jsx)("button",{onClick:l,className:"px-6 py-2.5 border border-gray-300 hover:bg-gray-50 text-gray-700 rounded-xl font-medium transition-colors",children:"Close"}),i&&(0,r.jsx)("button",{onClick:()=>{console.log("Edit farmer:",i)},className:"px-6 py-2.5 bg-primary hover:bg-emerald-700 text-white rounded-xl font-medium transition-colors",children:"Edit Farmer"})]})})]})}):null}var A=s(46046);function F(e){let{farmerId:a,open:s,onClose:l,onUpdate:i,getFarmerById:d}=e,[c,o]=(0,t.useState)(null),[m,u]=(0,t.useState)(!1),[x,g]=(0,t.useState)(!1),[f,w]=(0,t.useState)(null),[F,k]=(0,t.useState)({fullname:"",email:"",phone_number:"",address:"",nin:"",account_number:"",account_name:"",bankId:0,status:"pending",id:0});(0,t.useEffect)(()=>{s&&a?C():(o(null),w(null),_())},[s,a]);let C=async()=>{if(a){u(!0),w(null);try{let e=parseInt(a.replace(/\D/g,""));if(!e||isNaN(e))throw Error("Invalid farmer ID");let s=await d(e),r=(null==s?void 0:s.data)||s;o(r),k({fullname:r.fullname||"",email:r.email||"",phone_number:r.phone_number||"",address:r.address||"",nin:r.nin||"",account_number:r.account_number||"",account_name:r.account_name||"",bankId:r.bankId||0,status:r.status||"pending",id:r.id||0})}catch(a){var e,s;w((null==a||null==(s=a.response)||null==(e=s.data)?void 0:e.message)||(null==a?void 0:a.message)||"Failed to load farmer details"),console.error("Failed to fetch farmer:",a)}finally{u(!1)}}},_=()=>{k({fullname:"",email:"",phone_number:"",address:"",nin:"",account_number:"",account_name:"",bankId:0,status:"pending"})},I=e=>{let{name:a,value:s}=e.target;k(e=>({...e,[a]:"bankId"===a?parseInt(s)||0:s}))},S=async()=>{if(!c)return void w("No farmer data available");if(!c.id)return void w("Invalid farmer ID");if(!F.fullname||!F.phone_number||!F.address||!F.nin)return void w("Please fill in all required fields");g(!0),w(null);try{console.log("Updating farmer with ID:",c.id,"Data:",F),await i(c.id,F),l()}catch(s){var e,a;console.error("Update error:",s),w((null==s||null==(a=s.response)||null==(e=a.data)?void 0:e.message)||(null==s?void 0:s.message)||"Failed to update farmer")}finally{g(!1)}};return s?(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Edit Farmer"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Update farmer profile information"})]}),(0,r.jsx)("button",{onClick:l,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Close modal",children:(0,r.jsx)(h.A,{className:"w-6 h-6 text-gray-500"})})]}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:m?(0,r.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(n.A,{className:"w-12 h-12 animate-spin text-emerald-600 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-500",children:"Loading farmer details..."})]})}):f&&!c?(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-8 text-center",children:[(0,r.jsxs)("div",{className:"text-red-600 mb-4",children:[(0,r.jsx)("p",{className:"text-lg font-semibold mb-2",children:"Failed to Load Details"}),(0,r.jsx)("p",{className:"text-sm",children:f})]}),(0,r.jsx)("button",{type:"button",onClick:C,className:"mt-4 px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors",children:"Try Again"})]}):c?(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"bg-gradient-to-br from-emerald-600 to-emerald-500 rounded-xl p-6 text-white",children:(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"w-16 h-16 rounded-full bg-white/20 flex items-center justify-center text-2xl font-bold backdrop-blur-sm",children:c.profile_image&&"noimage.jpg"!==c.profile_image?(0,r.jsx)("img",{src:c.profile_image,alt:c.fullname,className:"w-full h-full rounded-full object-cover"}):c.fullname.split(" ").map(e=>e[0]).join("")}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm opacity-90",children:"Editing Farmer"}),(0,r.jsxs)("p",{className:"text-xl font-bold",children:["FRM",String(c.id).padStart(4,"0")]})]})]})}),f&&c&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:(0,r.jsx)("p",{className:"text-sm text-red-600",children:f})}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6",children:[(0,r.jsxs)("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,r.jsx)(j.A,{className:"w-5 h-5"}),"Personal Information"]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Full Name ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"text",name:"fullname",value:F.fullname,onChange:I,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter full name"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,r.jsx)(p.A,{className:"w-4 h-4 inline mr-1"}),"Phone Number ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"tel",name:"phone_number",value:F.phone_number,onChange:I,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter phone number"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,r.jsx)(y.A,{className:"w-4 h-4 inline mr-1"}),"Email Address"]}),(0,r.jsx)("input",{type:"email",name:"email",value:F.email,onChange:I,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter email address"})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,r.jsx)(b.A,{className:"w-4 h-4 inline mr-1"}),"Address ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("textarea",{name:"address",value:F.address,onChange:I,rows:3,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent resize-none",placeholder:"Enter full address"})]})]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6",children:[(0,r.jsxs)("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,r.jsx)(j.A,{className:"w-5 h-5"}),"Identification"]}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["National ID Number (NIN) ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"text",name:"nin",value:F.nin,onChange:I,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent font-mono",placeholder:"Enter NIN"})]})})]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6",children:[(0,r.jsxs)("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,r.jsx)(v.A,{className:"w-5 h-5"}),"Banking Information"]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Account Name ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"text",name:"account_name",value:F.account_name,onChange:I,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter account name"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,r.jsx)(N.A,{className:"w-4 h-4 inline mr-1"}),"Account Number ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"text",name:"account_number",value:F.account_number,onChange:I,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent font-mono",placeholder:"Enter account number"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Bank ID ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"number",name:"bankId",value:F.bankId,onChange:I,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter bank ID"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Status ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsxs)("select",{name:"status",value:F.status,onChange:I,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",children:[(0,r.jsx)("option",{value:"pending",children:"Pending"}),(0,r.jsx)("option",{value:"active",children:"Active"}),(0,r.jsx)("option",{value:"inactive",children:"Inactive"}),(0,r.jsx)("option",{value:"suspended",children:"Suspended"})]})]})]})]})]}):null}),(0,r.jsx)("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:(0,r.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,r.jsx)("button",{onClick:l,disabled:x,className:"px-6 py-2.5 border border-gray-300 hover:bg-gray-50 text-gray-700 rounded-xl font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),(0,r.jsx)("button",{onClick:S,disabled:x||m||!c,className:"px-6 py-2.5 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:x?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.A,{className:"w-5 h-5 animate-spin"}),"Saving..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(A.A,{className:"w-5 h-5"}),"Save Changes"]})})]})})]})}):null}function k(){let[e,a]=(0,t.useState)("all"),[s,h]=(0,t.useState)(!1),[g,f]=(0,t.useState)([]),[p,y]=(0,t.useState)(!0),[b,j]=(0,t.useState)(null),[v,N]=(0,t.useState)(null),[A,k]=(0,t.useState)(!1),[C,_]=(0,t.useState)(!1),[I,S]=(0,t.useState)(null),{fetchFarmers:z,farmers:D}=(0,o.z)();(0,t.useEffect)(()=>{P()},[]);let E=e=>({id:"FRM".concat(String(e.id).padStart(4,"0")),name:e.fullname,email:e.email,phone:e.phone_number,farmSize:"N/A",registrationDate:new Date(e.createdAt).toLocaleDateString(),status:e.status.toLowerCase(),nin:e.nin,address:e.address,state:"",lga:"",photoUrl:"noimage.jpg"!==e.profile_image?e.profile_image:void 0}),P=async()=>{y(!0),j(null);try{let e=await x.z.getFarmers(),a=((null==e?void 0:e.data)||[]).map(E);f(a)}catch(s){var e,a;j((null==s||null==(a=s.response)||null==(e=a.data)?void 0:e.message)||"Failed to load farmers"),console.error("Failed to fetch farmers:",s)}finally{y(!1)}},B=async e=>{try{return await x.z.getFarmerById(e)}catch(e){throw console.error("Failed to fetch farmer by ID:",e),e}},L=async(e,a)=>{try{let s="string"==typeof e?parseInt(e.replace(/\D/g,"")):e;await x.z.updateFarmer(s,a),c.oR.success("Farmer updated successfully")}catch(a){var s,r;let e=(null==a||null==(r=a.response)||null==(s=r.data)?void 0:s.message)||"Failed to update farmer";throw c.oR.error(e),a}},R=async e=>{try{c.oR.success("Farmer registered successfully"),h(!1),await P()}catch(e){throw c.oR.error("Failed to register farmer. Please try again."),e}},U="all"===e?g:g.filter(a=>a.status===e);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-1",children:"Farmer Management"}),(0,r.jsx)("p",{className:"text-gray-500",children:"Manage and onboard farmers across all regions"})]})}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"relative flex-1",children:(0,r.jsx)("input",{type:"text",placeholder:"Search farmers by name, ID, or phone...",className:"w-full px-4 py-3 bg-white border border-gray-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"})}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(l.A,{className:"w-5 h-5 text-gray-400"}),(0,r.jsxs)("select",{value:e,onChange:e=>a(e.target.value),className:"px-4 py-3 bg-white border border-gray-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",children:[(0,r.jsx)("option",{value:"all",children:"All Farmers"}),(0,r.jsx)("option",{value:"active",children:"Active"}),(0,r.jsx)("option",{value:"pending",children:"Pending"}),(0,r.jsx)("option",{value:"inactive",children:"Inactive"}),(0,r.jsx)("option",{value:"suspended",children:"Suspended"})]})]})]}),p?(0,r.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(n.A,{className:"w-12 h-12 animate-spin text-primary mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-500",children:"Loading farmers..."})]})}):b?(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-8 text-center",children:[(0,r.jsxs)("div",{className:"text-red-600 mb-4",children:[(0,r.jsx)(i.A,{className:"w-12 h-12 mx-auto mb-2"}),(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Failed to Load Farmers"}),(0,r.jsx)("p",{className:"text-sm mt-2",children:b})]}),(0,r.jsx)("button",{onClick:P,className:"mt-4 px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors",children:"Try Again"})]}):0===U.length?(0,r.jsxs)("div",{className:"bg-gray-50 border-2 border-dashed border-gray-300 rounded-xl p-12 text-center",children:[(0,r.jsx)(i.A,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"all"===e?"No Farmers Yet":"No ".concat(e.charAt(0).toUpperCase()+e.slice(1)," Farmers")}),(0,r.jsx)("p",{className:"text-gray-500 mb-6",children:"all"===e?"Get started by adding your first farmer to the system":"There are no ".concat(e," farmers at the moment")}),"all"===e?(0,r.jsxs)("button",{onClick:()=>h(!0),className:"inline-flex items-center gap-2 bg-primary hover:bg-emerald-700 text-white px-6 py-3 rounded-xl font-medium transition-colors",children:[(0,r.jsx)(d.A,{className:"w-5 h-5"}),"Add Your First Farmer"]}):(0,r.jsx)("button",{onClick:()=>a("all"),className:"inline-flex items-center gap-2 bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-3 rounded-xl font-medium transition-colors",children:"View All Farmers"})]}):(0,r.jsx)(m.A,{farmers:U,onView:e=>{N(e.id),k(!0)},onEdit:e=>{S(e.id),_(!0)}})]}),(0,r.jsx)(u.A,{open:s,onClose:()=>h(!1),onSubmit:R}),(0,r.jsx)(w,{farmerId:v,open:A,onClose:()=>{k(!1),N(null)}}),(0,r.jsx)(F,{farmerId:I,open:C,onClose:()=>{_(!1),S(null)},onUpdate:async(e,a)=>{await L(e,a),await P()},getFarmerById:B})]})}},22033:(e,a,s)=>{"use strict";s.d(a,{AdminProvider:()=>i,z:()=>d});var r=s(95155),t=s(12115),l=s(24958);let n=(0,t.createContext)(void 0),i=e=>{let{children:a}=e,[s,i]=(0,t.useState)([]),[d,c]=(0,t.useState)([]),[o,m]=(0,t.useState)(null),[u,x]=(0,t.useState)(!1),[h,g]=(0,t.useState)(null),f=(0,t.useCallback)(()=>g(null),[]),p=(0,t.useCallback)(async()=>{x(!0),g(null);try{let e=await l.z.getDashboard();m(e.data||e)}catch(s){var e,a;throw g((null==(a=s.response)||null==(e=a.data)?void 0:e.message)||"Failed to fetch dashboard data"),s}finally{x(!1)}},[]),y=(0,t.useCallback)(async()=>{x(!0),g(null);try{let e=await l.z.getFarmers(),a=(null==e?void 0:e.data)||[];i(a)}catch(s){var e,a;throw g((null==(a=s.response)||null==(e=a.data)?void 0:e.message)||"Failed to fetch farmers"),s}finally{x(!1)}},[]),b=(0,t.useCallback)(async e=>{x(!0),g(null);try{let a=await l.z.getFarmerById(e);return a.farmer||a}catch(e){var a,s;throw g((null==(s=e.response)||null==(a=s.data)?void 0:a.message)||"Failed to fetch farmer"),e}finally{x(!1)}},[]),j=(0,t.useCallback)(async e=>{x(!0),g(null);try{let a=await l.z.createFarmer(e);return await y(),a}catch(e){var a,s;throw g((null==(s=e.response)||null==(a=s.data)?void 0:a.message)||"Failed to create farmer"),e}finally{x(!1)}},[y]),v=(0,t.useCallback)(async(e,a)=>{x(!0),g(null);try{await l.z.updateFarmer(e,a),await y()}catch(e){var s,r;throw g((null==(r=e.response)||null==(s=r.data)?void 0:s.message)||"Failed to update farmer"),e}finally{x(!1)}},[y]),N=(0,t.useCallback)(async e=>{x(!0),g(null);try{await l.z.deleteFarmer(e),i(a=>a.filter(a=>a.id!==e))}catch(e){var a,s;throw g((null==(s=e.response)||null==(a=s.data)?void 0:a.message)||"Failed to delete farmer"),e}finally{x(!1)}},[]),w=(0,t.useCallback)(async()=>{x(!0),g(null);try{let e=await l.z.getFarms(),a=e.data||e.farms||e||[];c(Array.isArray(a)?a:[])}catch(s){var e,a;throw g((null==(a=s.response)||null==(e=a.data)?void 0:e.message)||"Failed to fetch farms"),c([]),s}finally{x(!1)}},[]),A=(0,t.useCallback)(async e=>{x(!0),g(null);try{let a=await l.z.getFarmById(e);return a.farm||a}catch(e){var a,s;throw g((null==(s=e.response)||null==(a=s.data)?void 0:a.message)||"Failed to fetch farm"),e}finally{x(!1)}},[]),F=(0,t.useCallback)(async e=>{x(!0),g(null);try{let a=await l.z.getFarmersFarms(e);return a.farms||a}catch(e){var a,s;throw g((null==(s=e.response)||null==(a=s.data)?void 0:a.message)||"Failed to fetch farmer farms"),e}finally{x(!1)}},[]),k=(0,t.useCallback)(async e=>{x(!0),g(null);try{let a=await l.z.createFarm(e);return await w(),a}catch(e){var a,s;throw g((null==(s=e.response)||null==(a=s.data)?void 0:a.message)||"Failed to create farm"),e}finally{x(!1)}},[w]),C=(0,t.useCallback)(async(e,a)=>{x(!0),g(null);try{await l.z.updateFarm(e,a),await w()}catch(e){var s,r;throw g((null==(r=e.response)||null==(s=r.data)?void 0:s.message)||"Failed to update farm"),e}finally{x(!1)}},[w]),_=(0,t.useCallback)(async e=>{x(!0),g(null);try{await l.z.deleteFarm(e),c(a=>a.filter(a=>a.id!==e))}catch(e){var a,s;throw g((null==(s=e.response)||null==(a=s.data)?void 0:a.message)||"Failed to delete farm"),e}finally{x(!1)}},[]),I=(0,t.useCallback)(async e=>{x(!0),g(null);try{return await l.z.sendCode(e)}catch(e){var a,s;throw g((null==(s=e.response)||null==(a=s.data)?void 0:a.message)||"Failed to send code"),e}finally{x(!1)}},[]),S=(0,t.useCallback)(async e=>{x(!0),g(null);try{return await l.z.verifyCode(e)}catch(e){var a,s;throw g((null==(s=e.response)||null==(a=s.data)?void 0:a.message)||"Failed to verify code"),e}finally{x(!1)}},[]),z=(0,t.useCallback)(async e=>{x(!0),g(null);try{return await l.z.verifyNin(e)}catch(e){var a,s;throw g((null==(s=e.response)||null==(a=s.data)?void 0:a.message)||"Failed to verify NIN"),e}finally{x(!1)}},[]),D=(0,t.useCallback)(async e=>{x(!0),g(null);try{return await l.z.initializePayment(e)}catch(e){var a,s;throw g((null==(s=e.response)||null==(a=s.data)?void 0:a.message)||"Failed to initialize payment"),e}finally{x(!1)}},[]),E=(0,t.useCallback)(async(e,a)=>{x(!0),g(null);try{return await l.z.verifyPayment(e,a)}catch(e){var s,r;throw g((null==(r=e.response)||null==(s=r.data)?void 0:s.message)||"Failed to verify payment"),e}finally{x(!1)}},[]),P=(0,t.useCallback)(async()=>{x(!0),g(null);try{return await l.z.getPaymentRevenue()}catch(s){var e,a;throw g((null==(a=s.response)||null==(e=a.data)?void 0:e.message)||"Failed to fetch payment revenue"),s}finally{x(!1)}},[]),B=(0,t.useCallback)(async()=>{x(!0),g(null);try{return await l.z.listPayments()}catch(s){var e,a;throw g((null==(a=s.response)||null==(e=a.data)?void 0:e.message)||"Failed to fetch payments list"),s}finally{x(!1)}},[]);return(0,r.jsx)(n.Provider,{value:{farmers:s,farms:d,dashboard:o,loading:u,error:h,fetchDashboard:p,fetchFarmers:y,getFarmerById:b,createFarmer:j,updateFarmer:v,deleteFarmer:N,fetchFarms:w,getFarmById:A,getFarmersFarms:F,createFarm:k,updateFarm:C,deleteFarm:_,sendCode:I,verifyCode:S,verifyNin:z,initailizePayment:D,verifyPayment:E,getPaymentRevenue:P,listPayments:B,clearError:f},children:a})},d=()=>{let e=(0,t.useContext)(n);if(!e)throw Error("useAdmin must be used within an AdminProvider");return e}},24958:(e,a,s)=>{"use strict";s.d(a,{z:()=>t});var r=s(12862);let t={getDashboard:async()=>(await r.A.get("/admin/dashboard")).data,createFarmer:async e=>(await r.A.post("/admin/create-farmer",e)).data,getFarmers:async()=>(await r.A.get("/admin/farmer/list-farmers")).data,getFarmerById:async e=>(await r.A.get("/admin/farmer/get-farmer?farmer_id=".concat(e))).data,sendCode:async e=>(await r.A.post("/admin/send-code",e)).data,verifyCode:async e=>(await r.A.post("/admin/verify-code",e)).data,verifyNin:async e=>(await r.A.post("/admin/verify-nin",e)).data,uploadProfileImage:async e=>(await r.A.post("/admin/upload-profile-image",e,{headers:{"Content-Type":"multipart/form-data"}})).data,UploadProofOfAddress:async e=>(await r.A.post("/admin/upload-proof-of-address",e,{headers:{"Content-Type":"multipart/form-data"}})).data,getBanks:async()=>(await r.A.get("/banks")).data,updateFarmer:async(e,a)=>(await r.A.put("/admin/farmer/update-farmer?id=".concat(e),a)).data,deleteFarmer:async e=>(await r.A.delete("/admin/farmers/".concat(e))).data,getFarms:async()=>(await r.A.get("/admin/farm/list-farms")).data,createFarm:async e=>(await r.A.post("/admin/farm/create-farm",e)).data,deleteFarm:async e=>(await r.A.delete("/admin/delete-farm?farm_id=".concat(e))).data,updateFarm:async(e,a)=>(await r.A.put("/admin/farm/update-farm?farm_id=".concat(e),a)).data,getFarmById:async e=>(await r.A.get("/admin/get-farm?farm_id=".concat(e))).data,getFarmersFarms:async e=>(await r.A.get("/admin/farmers-farms?farmer_id=".concat(e))).data,initializePayment:async e=>{console.log("=== PAYMENT INITIALIZATION DEBUG ==="),console.log("1. Data received by service:",e),console.log("2. Data stringified:",JSON.stringify(e));try{let a=await r.A.post("/admin/initialize-payment",e);return console.log("3. Full response received:",a),console.log("4. Response data:",a.data),a.data}catch(e){var a,s;throw console.error("4. Error caught in service:",e),console.error("5. Error response data:",null==(a=e.response)?void 0:a.data),console.error("6. Error request data:",null==(s=e.config)?void 0:s.data),e}},verifyPayment:async(e,a)=>(await r.A.get("/admin/verify-payment?trxref=".concat(e,"&reference=").concat(a))).data,getPaymentRevenue:async()=>(await r.A.get("/admin/payment/revenue")).data,listPayments:async()=>(await r.A.get("/admin/payment/list-payments")).data}},69014:(e,a,s)=>{Promise.resolve().then(s.bind(s,14092))}},e=>{e.O(0,[125,779,411,721,893,175,160,441,255,358],()=>e(e.s=69014)),_N_E=e.O()}]);